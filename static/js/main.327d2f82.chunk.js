(this["webpackJsonpreact-snake"]=this["webpackJsonpreact-snake"]||[]).push([[0],{17:function(e,t,n){},25:function(e,t){},27:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(11),i=n.n(c),o=(n(17),n(4)),u=n(12),s=n.n(u),l=n(29);function d(){return{type:"snake",bodyPart:"head",id:Object(l.a)()}}function f(e){return{type:"snake",bodyPart:"trunk",index:e.index,id:Object(l.a)()}}function b(){return{type:"snake",bodyPart:"tail",id:Object(l.a)()}}function j(){return{type:"food",id:Object(l.a)()}}function v(){return{type:"empty",id:Object(l.a)()}}var m=32,p=17;var h=[["left","right"].sort().join(","),["up","down"].sort().join(",")];var O,y=(O=m,new Array(p).fill(null).map((function(){return new Array(O).fill(null)})).map((function(e,t){return e.map((function(e,n){return{x:t,y:n}}))})).flat());function x(e,t){var n=y.filter((function(e){var n,r=e.x,a=e.y;return"snake"!==(null===(n=t[r][a])||void 0===n?void 0:n.type)}));return n[function(e,t){var n=t.max,r=t.min,a=void 0===r?0:r,c=s()(e);return function(){return a+Math.floor(c()*n)}}(e,{max:n.length})()]}function g(e,t){return new Array(t).fill(null).map((function(){return new Array(e).fill(null).map((function(){return v()}))}))}var w=n(0),k=function(e){var t=e.square;if("snake"===(null===t||void 0===t?void 0:t.type))switch(t.bodyPart){case"head":return Object(w.jsx)("div",{className:"bg-black dark:bg-green-300 w-vh-large h-vh-large"});case"trunk":return Object(w.jsx)("div",{className:"bg-black dark:bg-green-300 w-vh-medium h-vh-medium"});case"tail":return Object(w.jsx)("div",{className:"bg-black dark:bg-green-300 w-vh-xs h-vh-xs"})}return"food"===(null===t||void 0===t?void 0:t.type)?Object(w.jsx)("div",{className:"rounded-full bg-svelte-red w-vh-small h-vh-small"}):Object(w.jsx)("div",{className:"w-vh-large h-vh-large"})},S=function(e){var t=e.gameState.field.map((function(e,t){return e.map((function(e,n){return Object(w.jsx)(k,{square:e},"".concat(t).concat(n))}))}));return Object(w.jsx)("div",{className:"grid place-items-center gap-vh-small p-vh-small border-4 border-solid border-black dark:border-gray-200",style:{gridTemplateColumns:"repeat(".concat(m,", 3.6vh)"),gridTemplateRows:"repeat(".concat(p,", 3.6vh)")},children:t})},N=[{delay:3e5,description:'"Need to make some coffee" speed'},{delay:700,description:"Dead snail on a slope"},{delay:540,description:"Snail"},{delay:400,description:"Sloth"},{delay:320,description:"Snail running from a bird"},{delay:230,description:"Turtle"},{delay:160,description:"Turtle on a skateboard"},{delay:80,description:"Regular speed"},{delay:50,description:"Fast"},{delay:30,description:"Cheetah"},{delay:20,description:"Cheetah driving a Porsche"},{delay:10,description:"M-497 Black Beetle"},{delay:4,description:"Warp 11"}];function C(){return N.findIndex((function(e){return 80===e.delay}))}var E=function(e){var t=e.onSpeedChange,n=Object(r.useState)(!1),a=Object(o.a)(n,2),c=a[0],i=a[1],u=Object(r.useState)(C()),s=Object(o.a)(u,2),l=s[0],d=s[1];return Object(r.useEffect)((function(){t(N[l].delay)}),[t,l]),Object(w.jsxs)("div",{className:"mt-3 flex flex-col items-center justify-start h-12",onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)},children:[Object(w.jsx)("span",{children:N[l].description}),Object(w.jsx)("div",{className:"mt-1",children:Object(w.jsx)("input",{className:"w-56 mx-2 ".concat(c?"opacity-100":"opacity-0"," transition duration-500 ease-in-out"),type:"range",value:l,min:"0",max:N.length-1,step:"1",onChange:function(e){var n=parseInt(e.target.value,10);d(n),t(N[n].delay)}})})]})},P=n(9);var M=function(e){var t=e.current,n=Object(r.useState)(0),a=Object(o.a)(n,2),c=a[0],i=a[1],u=Object(r.useState)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{countDelay:20},n=Object(P.a)(e),r=n.subscribe,a=n.update,c=e;return{subscribe:r,newScore:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){if(e<c){var n=1500/(c-e);if(n<4)a((function(){return e}));else for(var r=c;r>e;r--)setTimeout((function(){return a((function(e){return e-1}))}),r*n)}else for(var i=1;i<=e-c;i++)setTimeout((function(){return a((function(e){return e+1}))}),i*t.countDelay);c=e}))}}()),s=Object(o.a)(u,1)[0];return Object(r.useEffect)((function(){return s.subscribe((function(e){i(e)}))}),[s]),s.newScore(t),Object(w.jsxs)(w.Fragment,{children:["Score: ",Object(w.jsx)("span",{children:c})]})},D=function(e){var t=e.onNewGameClick,n=e.finalScore;return Object(w.jsxs)("div",{className:"flex items-center justify-center flex-col opacity-90 bg-black fixed w-full h-full top-0 left-0 z-50",children:[Object(w.jsx)("h1",{className:"text-white text-3xl my-5",children:"Game over"}),Object(w.jsxs)("p",{className:"text-svelte-red uppercase text-7xl m-16",children:["Final score: ",n]}),Object(w.jsxs)("button",{className:"relative border-none rounded-md w-44 h-14 bg-svelte-red text-white text-base font-bold uppercase px-2 py-4 hover:bg-svelte-red-dark",onClick:t,children:["New game"," "]})]})},I=n(2);function z(e){return e.field}function L(e){return e.direction}function T(e){return e.snakeSize}function B(e,t){var n=function(e,t){var n;return e.forEach((function(e,r){e.forEach((function(e,a){return t(e)?n={row:r,column:a}:null}))})),n}(e,(function(e){return"snake"===(null===e||void 0===e?void 0:e.type)&&"head"===e.bodyPart})),r=n.column;"left"===t?r=n.column-1<0?31:n.column-1:"right"===t&&(r=n.column+1===m?0:n.column+1);var a=n.row;return"up"===t?a=n.row-1<0?16:n.row-1:"down"===t&&(a=n.row+1===p?0:n.row+1),{row:a,column:r}}var A=N[C()].delay,F=function(){};function G(e){var t=e.delay,n=void 0===t?A:t,r=e.logger,a=void 0===r?F:r,c=Object(P.a)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.floor(1e7*Math.random()),t=g(m,p);t[8][13]=b(),t[8][14]=f({index:3}),t[8][15]=f({index:2}),t[8][16]=f({index:1}),t[8][17]=f({index:0}),t[8][18]=d();var n=x(e,t);return t[n.x][n.y]=j(),{field:t,direction:"right",snakeSize:6,foodConsumed:!1,gameOver:!1,score:0}}()),i=c.subscribe,o=c.update,u=[],s=n,l=!1;function O(e){return setInterval((function(){a("Calling setInterval handler (delay: ".concat(e,")")),function(e,t){t&&e((function(e){return function(e,t){var n,r,a=L(e);return Object(I.a)(Object(I.a)({},e),{},{direction:(n=a,r=t,h.indexOf([n,r].sort().join(","))>=0?a:t)})}(e,t)}))}(o,u.shift()),o((function(e){var t=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.floor(1e7*Math.random()),r=z(e),a=T(e),c=B(r,L(e));if("snake"===(null===(t=r[c.row][c.column])||void 0===t?void 0:t.type)&&"tail"!=r[c.row][c.column].bodyPart)return Object(I.a)(Object(I.a)({},e),{},{gameOver:!0});var i=!1,o=r.map((function(t,n){return t.map((function(t,r){return"snake"===(null===t||void 0===t?void 0:t.type)&&"tail"===t.bodyPart?c.row===n&&c.column===r?Object(I.a)(Object(I.a)({},d()),{},{id:t.id}):e.foodConsumed?t:Object(I.a)(Object(I.a)({},v()),{},{id:t.id}):"snake"===(null===t||void 0===t?void 0:t.type)&&"head"===t.bodyPart?Object(I.a)(Object(I.a)({},f({index:0})),{},{id:t.id}):"snake"===(null===t||void 0===t?void 0:t.type)&&"trunk"===t.bodyPart?t.index!==a-3||e.foodConsumed?Object(I.a)(Object(I.a)({},f({index:t.index+1})),{},{id:t.id}):Object(I.a)(Object(I.a)({},b()),{},{id:t.id}):"empty"!==t.type&&"food"!==t.type||r!==c.column||n!==c.row?t:(t&&(i="food"===t.type),Object(I.a)(Object(I.a)({},d()),{},{id:t.id}))}))}));if(e.foodConsumed){var u=x(n,o);o[u.x][u.y]=Object(I.a)(Object(I.a)({},j()),{},{id:o[u.x][u.y].id})}return Object(I.a)(Object(I.a)({},e),{},{foodConsumed:i,field:o,snakeSize:e.foodConsumed?e.snakeSize+1:e.snakeSize,score:i?e.score+5:e.score})}(e);return t.gameOver&&clearInterval(y),t}))}),e)}var y=O(n);function w(e){s=e,clearInterval(y),y=O(e)}return{subscribe:i,changeDirection:function(e){l||u.push(e)},changeDelayBetweenMoves:w,togglePause:function(){l?(w(s),l=!1):(l=!0,clearInterval(y))},destroy:function(){clearInterval(y)}}}function q(e){e?window.document.documentElement.classList.add("dark"):window.document.documentElement.classList.remove("dark")}var J=function(){var e=Object(r.useState)((function(){return G({})})),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(void 0),i=Object(o.a)(c,2),u=i[0],s=i[1],l=Object(r.useState)(!0),d=Object(o.a)(l,2),f=d[0],b=d[1];Object(r.useEffect)((function(){return n.subscribe((function(e){return s(e)})),n.destroy}),[n]),Object(r.useEffect)((function(){q(f)}),[f]),Object(r.useEffect)((function(){function e(e){var t=e.key.toLowerCase();"w"===t?n.changeDirection("up"):"s"===t?n.changeDirection("down"):"d"===t?n.changeDirection("right"):"a"===t?n.changeDirection("left"):"p"===t&&n.togglePause()}return window.addEventListener("keypress",e),function(){return window.removeEventListener("keypress",e)}}),[n]);var j=Object(r.useCallback)((function(e){n.changeDelayBetweenMoves(e)}),[n]);if(!u)return Object(w.jsx)(w.Fragment,{});return Object(w.jsxs)("main",{className:"flex flex-col items-center",children:[Object(w.jsx)("h1",{className:"uppercase text-7xl text-svelte-red font-thin my-12",children:"Snake"}),Object(w.jsxs)("div",{className:"flex flex-col items-start",children:[Object(w.jsxs)("span",{className:"flex justify-between text-3xl w-full",children:[Object(w.jsx)("span",{children:Object(w.jsx)(M,{current:u.score})}),Object(w.jsx)("button",{onClick:function(){b((function(e){return!e})),q(f)},children:f?"\u2600\ufe0f":"\ud83c\udf19"})]}),Object(w.jsx)(S,{gameState:u})]}),Object(w.jsx)(E,{onSpeedChange:j}),u.gameOver&&Object(w.jsx)(D,{onNewGameClick:function(){n.destroy(),a(G({}))},finalScore:u.score})]})};i.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(J,{})}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.327d2f82.chunk.js.map